<!DOCTYPE html>

<html lang="ko">
<head>
<meta charset="utf-8"/>
<title>ìŠ¤ì½”ì–´ ì…ë ¥</title>
<style>
    body {
      font-family: sans-serif;
      padding: 20px;
      background-color: #f0f0f0;
    }
    .section {
      margin-bottom: 20px;
      background: #fff;
      padding: 15px;
      border-radius: 10px;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
    }
    label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
    }
    input[type="text"], select {
      width: 100%;
      padding: 8px;
      margin-bottom: 10px;
      border-radius: 5px;
      border: 1px solid #ccc;
    }
    .button-group button {
      margin: 5px;
      padding: 10px 15px;
      font-size: 16px;
    }
    .checkbox-group label {
      margin-right: 10px;
    }
  
.status-alert {
  color: red;
  font-weight: bold;
  animation: flash 0.3s ease-in-out 2;
}
@keyframes flash {
  0% { background-color: yellow; }
  50% { background-color: transparent; }
  100% { background-color: yellow; }
}

.status-alert {
  color: red;
  font-weight: bold;
  animation: flash 0.3s ease-in-out 2;
}
@keyframes flash {
  0% { background-color: yellow; }
  50% { background-color: transparent; }
  100% { background-color: yellow; }
}
</style>
</head>
<body>
<h1>ìŠ¤ì½”ì–´ë³´ë“œ ì…ë ¥</h1>
<div class="section">
<label>íŒ€ëª…</label>
<input id="team1" oninput="send('team1', this.value)" placeholder="í™”ì‹ì´ˆ" type="text"/><button onclick="document.getElementById('team1').value=''; localStorage.removeItem('team1'); document.getElementById('label1').textContent = 'íŒ€ëª…1:'">ë¦¬ì…‹</button>
<input id="team2" oninput="send('team2', this.value)" placeholder="ëª…ì‹ì´ˆ" type="text"/><button onclick="document.getElementById('team2').value=''; localStorage.removeItem('team2'); document.getElementById('label2').textContent = 'íŒ€ëª…2:'">ë¦¬ì…‹</button>
</div>
<div class="section">
<label>ì ìˆ˜ ì¡°ì •</label>
<div class="button-group">
<span id="label1"><span class="score1-label">í™”ì‹ì´ˆ</span>:</span>
<button onclick="adjustScore('score1', 1)">+</button>
<button onclick="adjustScore('score1', -1)">-</button>
<span id="label2"><span class="score2-label">ëª…ì‹ì´ˆ</span>:</span>
<button onclick="adjustScore('score2', 1)">+</button>
<button onclick="adjustScore('score2', -1)">-</button>
</div>
<button onclick="localStorage.removeItem('score1'); localStorage.removeItem('score2')">ë¦¬ì…‹</button><div id="score_status" style="margin-top: 5px; font-weight: bold;">ì ìˆ˜ ìƒíƒœ - <span class="score1-label">í™”ì‹ì´ˆ</span>: 0 / <span class="score2-label">ëª…ì‹ì´ˆ</span>: 0</div></div>
<div class="section">
<label>ë³¼ì¹´ìš´íŠ¸</label>
<div class="button-group">
<span>ë³¼:</span>
<button onclick="adjustCount('ball', 1)">+</button>
<button onclick="adjustCount('ball', -1)">-</button>
<span>ìŠ¤íŠ¸ë¼ì´í¬:</span>
<button onclick="adjustCount('strike', 1)">+</button>
<button onclick="adjustCount('strike', -1)">-</button>
</div>
<button onclick="localStorage.removeItem('ball'); localStorage.removeItem('strike')">ë¦¬ì…‹</button><div id="ball_status" style="margin-top: 5px; font-weight: bold;">ë³¼ì¹´ìš´íŠ¸ ìƒíƒœ: 0</div><div id="strike_status" style="margin-top: 5px; font-weight: bold;">ìŠ¤íŠ¸ë¼ì´í¬ ìƒíƒœ: 0</div></div>
<div class="section">
<label>ì•„ì›ƒ</label>
<div class="button-group">
<button onclick="adjustCount('out', 1)">+</button>
<button onclick="adjustCount('out', -1)">-</button>
</div>
<button onclick="localStorage.removeItem('out')">ë¦¬ì…‹</button><div id="out_status" style="margin-top: 5px; font-weight: bold;">ì•„ì›ƒ ìƒíƒœ: 0</div></div>
<div class="section">
<label id="inning_label">ì´ë‹</label>
<button onclick="localStorage.removeItem('inning')">ë¦¬ì…‹</button><div class="button-group"><button onclick="adjustInning(-1)">-</button><button onclick="adjustInning(1)">+</button></div><div id="inning_status" style="margin-top: 5px; font-weight: bold;">ì´ë‹ ìƒíƒœ: 0</div></div>
<div class="section">
<label>ì£¼ë£¨ìƒí™©</label>
<div class="checkbox-group">
<label><input id="base1" onchange="send('base1', this.checked)" type="checkbox"/> 1ë£¨</label>
<label><input id="base2" onchange="send('base2', this.checked)" type="checkbox"/> 2ë£¨</label>
<label><input id="base3" onchange="send('base3', this.checked)" type="checkbox"/> 3ë£¨</label>
</div>
<button onclick="localStorage.removeItem('base1'); localStorage.removeItem('base2'); localStorage.removeItem('base3')">ë¦¬ì…‹</button></div>
<script>
function updateStatusDisplay() {
  document.getElementById("ball_status").textContent = "ë³¼ì¹´ìš´íŠ¸ ìƒíƒœ: " + (localStorage.getItem("ball") || 0);
  document.getElementById("strike_status").textContent = "ìŠ¤íŠ¸ë¼ì´í¬ ìƒíƒœ: " + (localStorage.getItem("strike") || 0);
  document.getElementById("out_status").textContent = "ì•„ì›ƒ ìƒíƒœ: " + (localStorage.getItem("out") || 0);
  document.getElementById("inning_status").textContent = "ì´ë‹ ìƒíƒœ: " + (localStorage.getItem("inning") || "1íšŒì´ˆ");
  document.getElementById("score_status").textContent = "ì ìˆ˜ ìƒíƒœ - <span id="score1-label">í™”ì‹ì´ˆ</span>: " + (localStorage.getItem("score1") || 0) + " / <span id="score2-label">ëª…ì‹ì´ˆ</span>: " + (localStorage.getItem("score2") || 0);

  // ì£¼ë£¨ìƒí™© ì²´í¬ë°•ìŠ¤ ë™ê¸°í™”
  ['base1', 'base2', 'base3'].forEach(id => {
    document.getElementById(id).checked = localStorage.getItem(id) === "true";
  });

  // ì•„ì›ƒ ê³µ ë‘ ê°œ ìƒíƒœ í‘œì‹œìš©
  const outSection = document.getElementById("out_status");
  if (outSection) {
    const outCount = parseInt(localStorage.getItem("out") || "0");
    let html = "ì•„ì›ƒ ìƒíƒœ: ";
    for (let i = 0; i < 2; i++) {
      html += `<span style="display:inline-block;width:12px;height:12px;margin:2px;border-radius:50%;background-color:${i &lt; outCount ? 'red' : '#ddd'};"></span>`;
    }
    outSection.innerHTML = html;
  }
}

function highlightEffect(id) {
  const el = document.getElementById(id);
  el.classList.add("status-alert");
  setTimeout(() => el.classList.remove("status-alert"), 800);
}

function adjustScore(id, change) {
  let el = localStorage.getItem(id) || "0";
  let newVal = Math.max(0, parseInt(el) + change);
  localStorage.setItem(id, newVal);
  updateStatusDisplay();
}

function adjustCount(type, change) {
  let value = parseInt(localStorage.getItem(type) || "0");
  if (type === "strike") {
    if (value >= 2 && change > 0) {
      localStorage.setItem("strike", 0);
      localStorage.setItem("ball", 0);
      highlightEffect("strike_status");
      highlightEffect("ball_status");
      let out = parseInt(localStorage.getItem("out") || "0") + 1;
      localStorage.setItem("out", out);
      highlightEffect("out_status");
      if (out >= 3) {
        incrementInning();
        localStorage.setItem("out", 0);
        localStorage.setItem("ball", 0);
        localStorage.setItem("strike", 0);
        localStorage.setItem("base1", false);
        localStorage.setItem("base2", false);
        localStorage.setItem("base3", false);
        highlightEffect("inning_status");
      }
    } else {
      value = Math.min(2, Math.max(0, value + change));
      localStorage.setItem(type, value);
    }
  } else if (type === "ball") {
    if (value >= 3 && change > 0) {
      localStorage.setItem("ball", 0);
      localStorage.setItem("strike", 0);
      highlightEffect("ball_status");
      highlightEffect("strike_status");
    } else {
      value = Math.min(3, Math.max(0, value + change));
      localStorage.setItem(type, value);
    }
  } else if (type === "out") {
    value = Math.min(3, Math.max(0, value + change));
    localStorage.setItem(type, value);
  }
  updateStatusDisplay();
}

function incrementInning() {
  let inning = localStorage.getItem("inning") || "1íšŒì´ˆ";
  let num = parseInt(inning);
  let isTop = inning.includes("ì´ˆ");
  let step = isTop ? 0 : 1;
  let idx = (num - 1) * 2 + step + 1;

  if (idx > 17) idx = 17;

  const innArr = [];
  for (let i = 1; i <= 9; i++) {
    innArr.push(i + "íšŒì´ˆ");
    innArr.push(i + "íšŒë§");
  }

  localStorage.setItem("inning", innArr[idx]);

  // ì´ë‹ ë°”ë€Œë©´ ì£¼ë£¨ìƒí™© ë¦¬ì…‹
  localStorage.setItem("base1", false);
  localStorage.setItem("base2", false);
  localStorage.setItem("base3", false);
  updateStatusDisplay();
}

function adjustInning(change) {
  let inning = localStorage.getItem("inning") || "1íšŒì´ˆ";
  let num = parseInt(inning);
  let isTop = inning.includes("ì´ˆ");
  let step = isTop ? 0 : 1;
  let idx = (num - 1) * 2 + step + change;

  if (idx < 0) idx = 0;
  if (idx > 17) idx = 17;

  const innArr = [];
  for (let i = 1; i <= 9; i++) {
    innArr.push(i + "íšŒì´ˆ");
    innArr.push(i + "íšŒë§");
  }

  localStorage.setItem("inning", innArr[idx]);

  // ì£¼ë£¨ìƒí™© ë¦¬ì…‹
  localStorage.setItem("base1", false);
  localStorage.setItem("base2", false);
  localStorage.setItem("base3", false);
  updateStatusDisplay();
}

// onload ë° ë¦¬ì…‹ ë²„íŠ¼ UI ë™ê¸°í™”
window.onload = () => {
  updateStatusDisplay();
  document.querySelectorAll("button").forEach(btn => {
    if (btn.textContent.includes("ë¦¬ì…‹")) {
      btn.addEventListener("click", () => setTimeout(updateStatusDisplay, 100));
    }
  });
};</script><script>
const ws = new WebSocket("ws://" + location.hostname + ":8765");
ws.onopen = () => console.log("âœ… WebSocket ì—°ê²°ë¨");

function send(type, value) {
  const payload = { type, value };
  console.log("ğŸ“¤ ì „ì†¡:", payload);
  if (ws.readyState === WebSocket.OPEN) {
    ws.send(JSON.stringify(payload));
  } else {
    console.warn("âŒ WebSocket ë‹«í˜ ìƒíƒœ, ì „ì†¡ ì‹¤íŒ¨:", payload);
  }
}

function adjustCount(type, change) {
  let count = parseInt(localStorage.getItem(type) || "0");
  count += change;
  if (count < 0) count = 0;
  if (type === "ball" && count > 3) count = 3;
  if (type === "strike" && count > 2) count = 2;
  localStorage.setItem(type, count);
  document.getElementById(type).textContent = count;
  send(type, count);  // âœ… ì „ì†¡ ì¶”ê°€
}

function adjustScore(id, change) {
  let score = parseInt(localStorage.getItem(id) || "0");
  score += change;
  if (score < 0) score = 0;
  localStorage.setItem(id, score);
  document.getElementById(id).textContent = score;
  send(id, score);  // âœ… ì „ì†¡ ì¶”ê°€
}

function adjustInning(change) {
  const options = ["1íšŒì´ˆ", "1íšŒë§", "2íšŒì´ˆ", "2íšŒë§", "3íšŒì´ˆ", "3íšŒë§", "4íšŒì´ˆ", "4íšŒë§",
                   "5íšŒì´ˆ", "5íšŒë§", "6íšŒì´ˆ", "6íšŒë§", "7íšŒì´ˆ", "7íšŒë§", "8íšŒì´ˆ", "8íšŒë§", "9íšŒì´ˆ", "9íšŒë§"];
  let current = localStorage.getItem("inning") || "1íšŒì´ˆ";
  let index = options.indexOf(current);
  index = Math.min(Math.max(index + change, 0), options.length - 1);
  const next = options[index];
  localStorage.setItem("inning", next);
  document.getElementById("inning").textContent = next;
  send("inning", next);  // âœ… ì „ì†¡ ì¶”ê°€
}

document.getElementById("team1")?.addEventListener("input", e => {
  const label = document.querySelector("label[for='score1']");
  if (label) label.textContent = e.target.value + " ì ìˆ˜";
});
document.getElementById("team2")?.addEventListener("input", e => {
  const label = document.querySelector("label[for='score2']");
  if (label) label.textContent = e.target.value + " ì ìˆ˜";
});

document.getElementById("team1")?.addEventListener("input", e => {
});
document.getElementById("team2")?.addEventListener("input", e => {
});

document.getElementById("team1")?.addEventListener("input", e => {
  document.querySelectorAll(".score1-label").forEach(el => el.textContent = e.target.value);
});
document.getElementById("team2")?.addEventListener("input", e => {
  document.querySelectorAll(".score2-label").forEach(el => el.textContent = e.target.value);
});

document.getElementById("reset-ball")?.addEventListener("click", () => {
  send('ball', 0); document.getElementById('ball').textContent = '0';
});


document.getElementById("reset-strike")?.addEventListener("click", () => {
  send('strike', 0); document.getElementById('strike').textContent = '0';
});


document.getElementById("reset-out")?.addEventListener("click", () => {
  send('out', 0); document.getElementById('out').textContent = '0';
});


document.getElementById("reset-score")?.addEventListener("click", () => {
  send('score1', 0); send('score2', 0); document.getElementById('score1').textContent = '0'; document.getElementById('score2').textContent = '0';
});


document.getElementById("reset-inning")?.addEventListener("click", () => {
  send('inning', '1íšŒì´ˆ'); document.getElementById('inning').textContent = '1íšŒì´ˆ';
});


document.getElementById("reset-base")?.addEventListener("click", () => {
  send('base1', false); send('base2', false); send('base3', false);
});
</script><span id="score1">0</span><span id="score2">0</span><span id="ball">0</span><span id="strike">0</span><span id="out">0</span><span id="inning">1íšŒì´ˆ</span></body>
</html>