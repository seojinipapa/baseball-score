<!DOCTYPE html>

<html lang="ko">
<head>
<meta charset="utf-8"/>
<title>ìŠ¤ì½”ì–´ ì…ë ¥ - ë””ë²„ê¹…</title>
<style>
    /* --- ë™ì¼í•œ CSS ìŠ¤íƒ€ì¼ --- */
    body { font-family: sans-serif; padding: 20px; background-color: #f0f0f0; }
    .section { margin-bottom: 20px; background: #fff; padding: 15px; border-radius: 10px; box-shadow: 0 0 5px rgba(0,0,0,0.1); }
    label { display: block; margin-bottom: 5px; font-weight: bold; }
    input[type="text"] { width: calc(50% - 12px); padding: 8px; margin-bottom: 10px; border-radius: 5px; border: 1px solid #ccc; display: inline-block; }
    input[type="text"]:first-of-type { margin-right: 5px; }
    .team-inputs label { margin-bottom: 5px; }
    .button-group { display: flex; align-items: center; gap: 10px; margin-bottom: 10px; flex-wrap: wrap; }
    .button-group button { padding: 8px 12px; font-size: 16px; cursor: pointer; }
    .score-controls { display: flex; align-items: center; gap: 5px; }
    .score-label { font-weight: bold; min-width: 60px; text-align: right; margin-right: 3px; }
    .score-controls span[id^="score"] { font-weight: bold; font-size: 1.2em; min-width: 20px; text-align: center; padding: 0 5px; background-color: #eee; border-radius: 3px; }
    .checkbox-group label { margin-right: 10px; cursor: pointer; }
    .status-alert { animation: flash 0.4s ease-in-out 2; }
    @keyframes flash { 0%, 100% { background-color: transparent; } 50% { background-color: yellow; } }
     #ball_status, #strike_status, #out_status, #inning_status { margin-top: 5px; font-weight: bold; padding: 5px; background-color: #e9e9e9; border-radius: 4px; }
     #out_status span { display: inline-block; width: 12px; height: 12px; margin: 0 2px; border-radius: 50%; vertical-align: middle; }
</style>
</head>
<body>
<h1>ìŠ¤ì½”ì–´ë³´ë“œ ì…ë ¥ - ë””ë²„ê¹…</h1>
<div class="section team-inputs">
<label>íŒ€ëª…</label>
<input id="team1" placeholder="íŒ€1 ì´ë¦„" type="text"/>
<input id="team2" placeholder="íŒ€2 ì´ë¦„" type="text"/>
</div>
<div class="section">
<label>ì ìˆ˜ ì¡°ì •</label>
<div class="button-group">
<div class="score-controls">
<span class="score1-label score-label">íŒ€1</span>:
          <button id="btn-score1-plus">+</button>
<span id="score1">0</span>
<button id="btn-score1-minus">-</button>
</div>
<span>Â |Â </span>
<div class="score-controls">
<span class="score2-label score-label">íŒ€2</span>:
          <button id="btn-score2-plus">+</button>
<span id="score2">0</span>
<button id="btn-score2-minus">-</button>
</div>
</div>
<button id="reset-score">ì ìˆ˜ ë¦¬ì…‹</button>
</div>
<div class="section">
<label>ë³¼ì¹´ìš´íŠ¸</label>
<div class="button-group">
<span>B:</span><button id="btn-ball-plus">+</button><button id="btn-ball-minus">-</button>
<span>S:</span><button id="btn-strike-plus">+</button><button id="btn-strike-minus">-</button>
<span>O:</span><button id="btn-out-plus">+</button><button id="btn-out-minus">-</button>
</div>
<div id="ball_status">ë³¼: 0</div>
<div id="strike_status">ìŠ¤íŠ¸ë¼ì´í¬: 0</div>
<div id="out_status">ì•„ì›ƒ: </div>
<button id="reset-counts">ì¹´ìš´íŠ¸ ë¦¬ì…‹</button>
</div>
<div class="section">
<label>ì´ë‹</label>
<div class="button-group">
<button id="btn-inning-minus">-</button><span id="inning_status">1íšŒì´ˆ</span><button id="btn-inning-plus">+</button>
</div>
<button id="reset-inning">ì´ë‹ ë¦¬ì…‹</button>
</div>
<div class="section">
<label>ì£¼ë£¨ìƒí™©</label>
<div class="checkbox-group">
<label><input id="base1" type="checkbox"/> 1ë£¨</label>
<label><input id="base2" type="checkbox"/> 2ë£¨</label>
<label><input id="base3" type="checkbox"/> 3ë£¨</label>
</div>
<button id="reset-bases">ì£¼ë£¨ ë¦¬ì…‹</button>
</div>
<script>
let ws;

let ballCount = 0;
let strikeCount = 0;
let outCount = 0;
let inning = 1;
let bases = [false, false, false]; // 1ë£¨, 2ë£¨, 3ë£¨

function send(type, value) {
  if (ws && ws.readyState === WebSocket.OPEN) {
    const data = { type, value };
    console.log("ğŸ“¤ ì „ì†¡:", data);
    ws.send(JSON.stringify(data));
  }
}

function updateBallDisplay() {
  const el = document.getElementById("ball_status");
  if (el) {
    el.textContent = "ë³¼: " + ballCount;
  }
  send("ball", ballCount);
}

function updateStrikeDisplay() {
  const el = document.getElementById("strike_status");
  if (el) {
    el.textContent = "ìŠ¤íŠ¸ë¼ì´í¬: " + strikeCount;
  }
  send("strike", strikeCount);
}

function updateOutDisplay() {
  const el = document.getElementById("out_status");
  if (el) {
    el.textContent = "ì•„ì›ƒ: " + outCount;
  }
  send("out", outCount);
}

function updateInningDisplay() {
  const el = document.getElementById("inning_status");
  if (el) {
    el.textContent = "ì´ë‹: " + inning;
  }
  send("inning", inning);
}

function resetBaseAndCounts() {
  bases = [false, false, false];
  ballCount = 0;
  strikeCount = 0;
  updateBallDisplay();
  updateStrikeDisplay();
  send("base1", false);
  send("base2", false);
  send("base3", false);
}

window.addEventListener("DOMContentLoaded", () => {
  ws = new WebSocket("ws://" + location.hostname + ":8765");

  document.getElementById("btn-ball-plus")?.addEventListener("click", () => {
    ballCount++;
    if (ballCount >= 4) {
      ballCount = 0;
    }
    updateBallDisplay();
  });

  document.getElementById("btn-ball-minus")?.addEventListener("click", () => {
    if (ballCount > 0) {
      ballCount--;
      updateBallDisplay();
    }
  });

  document.getElementById("btn-strike-plus")?.addEventListener("click", () => {
        strikeCount++;
        if (strikeCount >= 3) {
          strikeCount = 0;
          ballCount = 0;
          base1 = base2 = base3 = false;
          outCount++;
          updateOutDisplay();
          updateBaseDisplay();
          updateBallDisplay();
          updateStrikeDisplay();
          if (outCount >= 3) {
            outCount = 0;
            if (isTop) {
              isTop = false;
            } else {
              if (inningNum < 12) inningNum++;
              isTop = true;
            }
            updateInningDisplay();
            updateOutDisplay();
            updateBaseDisplay();
            updateBallDisplay();
            updateStrikeDisplay();
          }
        }
    if (strikeCount >= 3) {
      strikeCount = 0;
      updateStrikeDisplay();
      outCount++;
      if (outCount >= 3) {
        outCount = 0;
        inning++;
        resetBaseAndCounts();
        updateInningDisplay();
      }
      updateOutDisplay();
    } else {
      updateStrikeDisplay();
    }
  });

  document.getElementById("btn-strike-minus")?.addEventListener("click", () => {
    if (strikeCount > 0) {
      strikeCount--;
      updateStrikeDisplay();
    }
  });

  document.getElementById("btn-out-plus")?.addEventListener("click", () => {
    outCount++;
    if (outCount >= 3) {
      outCount = 0;
      inning++;
      resetBaseAndCounts();
      updateInningDisplay();
    }
    updateOutDisplay();
  });

  document.getElementById("btn-out-minus")?.addEventListener("click", () => {
    if (outCount > 0) {
      outCount--;
      updateOutDisplay();
    }
  });
});</script></body>
</html>
